## Detect abandoned fishing gear with Pytorch

### Install requirements

1. Install GDAL
`brew install gdal`

2. Install GDAL Python bindings
`pip install gdal`

3. Install Rasterio
`pip install rasterio`

### Generate positive training data

Specific training data will be generated by running 

`PYTHONPATH=src python src/training_data/image-crop.py`.

The script takes a geojson file and crops training images with a size of 42 x 42 px around the provided geo coordinates.

The following variables can be customised in src/config.ini:

```
# File that contains geopositions of training data (e.g. aquafarms)
geojson_file_path=./data/geo/geojson/aquafarms_20180611.geojson

# Path to satellite imagery used to crop training data from
satellite_imagery_path=./imagery/training_data/raw/planet/aquafarms/*.tif

# Path where processed training data is stored
cropped_training_data_path=./imagery/training_data/cropped/
```

### Generate negative training data

1. Retile images that contain the training data

`python src/test_data/gdal_retile.py -targetDir imagery/training_data/raw/cropped imagery/training_data/raw/planet/[imagename].tif -ps 42 42`

2. Find and label negative training data


### Generate test data

Test data has to be cropped into tiles that have the same size as the training data. This can be done with the help of [gdal_retile.py](http://www.gdal.org/gdal_retile.html).

With the following command an image will be split into multiple images with a size of 42px x 42px.

`python src/test_data/gdal_retile.py -targetDir imagery/test_data/processed/eddies/pelops imagery/test_data/raw/planet/eddies/[imagename].tif -ps 42 42`

## Convolutional Neuronal Network

### Install requirements

1. Install pytorch

`pip install torch`

2. Install Torchvision

`pip install torchvision`

3. Install Numpy

`pip install numpy`

4. Install matplotlib

`pip install matplotlib`

### Train network with the provided training data

`PYTHONPATH=src python src/convnet/image_classifier.py train`

The following variables can be customised in src/config.ini:

```
# Path to data for training the network
training_data=./imagery/training_data/classified

# Path to data used for validating the network accuracy
validation_data=./imagery/validation_data/classified
```

### Use the trained network for prediction on the provided test data

`PYTHONPATH=src python src/convnet/image_classifier.py predict`

The following variables can be customised in src/config.ini:

```
# Path to data used for prediction
test_data=./imagery/test_data/cropped/eddies/benghazi
```
